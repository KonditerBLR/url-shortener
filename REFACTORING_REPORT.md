# –û—Ç—á–µ—Ç –ø–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É –ø—Ä–æ–µ–∫—Ç–∞ URL Shortener

## –î–∞—Ç–∞: 2025-11-20
## –í–µ—Ä—Å–∏—è: 1.0

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–†–µ–∑—é–º–µ](#—Ä–µ–∑—é–º–µ)
2. [–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è](#–∞–Ω–∞–ª–∏–∑-—Ç–µ–∫—É—â–µ–≥–æ-—Å–æ—Å—Ç–æ—è–Ω–∏—è)
3. [–í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#–≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã)
4. [–ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥](#–ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π-—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)
5. [–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–Ω–æ–≤–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
6. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —É–ª—É—á—à–µ–Ω–∏—é](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-–¥–∞–ª—å–Ω–µ–π—à–µ–º—É-—É–ª—É—á—à–µ–Ω–∏—é)
7. [–ú–∏–≥—Ä–∞—Ü–∏—è](#–º–∏–≥—Ä–∞—Ü–∏—è)

---

## –†–µ–∑—é–º–µ

–ü—Ä–æ–µ–∫—Ç **URL Shortener** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–µ—Ä–≤–∏—Å —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, –∑–∞—â–∏—Ç—ã –ø–∞—Ä–æ–ª–µ–º, —Ç–µ–≥–∞–º–∏, webhook'–∞–º–∏ –∏ API –∫–ª—é—á–∞–º–∏.

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —Ñ–∞–π–ª `routes.js` (1448 —Å—Ç—Ä–æ–∫)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (–Ω–∞—Ä—É—à–µ–Ω–∏–µ SRP)
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Controllers ‚Üí Services ‚Üí Repositories)
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∫–æ–¥–∞

---

## –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–¥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

```
url-shortener/
‚îú‚îÄ‚îÄ auth.js                 # 234 —Å—Ç—Ä–æ–∫–∏ - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îú‚îÄ‚îÄ routes.js               # 1448 —Å—Ç—Ä–æ–∫ - –í–°–ï –º–∞—Ä—à—Ä—É—Ç—ã API
‚îú‚îÄ‚îÄ server.js               # 240 —Å—Ç—Ä–æ–∫ - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ db.js                   # 30 —Å—Ç—Ä–æ–∫ - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îú‚îÄ‚îÄ email.js                # 88 —Å—Ç—Ä–æ–∫ - –æ—Ç–ø—Ä–∞–≤–∫–∞ email
‚îú‚îÄ‚îÄ utils.js                # 14 —Å—Ç—Ä–æ–∫ - —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ public/                 # –§—Ä–æ–Ω—Ç–µ–Ω–¥
‚îî‚îÄ‚îÄ migrations/             # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **Backend:** Node.js, Express.js
- **Database:** PostgreSQL
- **Auth:** JWT, bcrypt
- **Email:** Nodemailer
- **QR Codes:** qrcode

---

## –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1.1 –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π `routes.js` (1448 —Å—Ç—Ä–æ–∫)
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–µ—Å—å API –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ, –≤–∫–ª—é—á–∞—è:
- URL shortening
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- –¢–µ–≥–∏
- Webhooks
- API –∫–ª—é—á–∏
- –ê–Ω–∞–ª–∏—Ç–∏–∫—É

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –°–ª–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π –∫–æ–¥
- –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –≤ –∫–æ–º–∞–Ω–¥–µ
- –°–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

#### 1.2 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–ª–æ—è —Å–µ—Ä–≤–∏—Å–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Å–º–µ—à–∞–Ω–∞ —Å –º–∞—Ä—à—Ä—É—Ç–∞–º–∏

**–ü—Ä–∏–º–µ—Ä:**
```javascript
// –ü–ª–æ—Ö–æ: –ª–æ–≥–∏–∫–∞ –ø—Ä—è–º–æ –≤ –º–∞—Ä—à—Ä—É—Ç–µ
router.post('/shorten', async (req, res) => {
  try {
    const { url, customCode } = req.body;

    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if (!url) return res.status(400).json({ error: 'URL is required' });

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞
    let shortCode = customCode || generateShortCode();

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
    let exists = await db.query('SELECT * FROM urls WHERE short_code = $1', [shortCode]);
    while (exists.rows.length > 0) {
      shortCode = generateShortCode();
      exists = await db.query('SELECT * FROM urls WHERE short_code = $1', [shortCode]);
    }

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    await db.query('INSERT INTO urls ...', [...]);

    // ...
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
});
```

#### 1.3 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
**–ü—Ä–∏–º–µ—Ä—ã –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–º –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –≤ 10+ –º–µ—Å—Ç–∞—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ `try-catch` —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∫–æ–¥–æ–º
- –ü–∞—Ä—Å–∏–Ω–≥ JWT —Ç–æ–∫–µ–Ω–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö

#### 1.4 –°–ª–∞–±–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–∞ –ø–æ –º–∞—Ä—à—Ä—É—Ç–∞–º

```javascript
// –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ –∫–∞–∂–¥–æ–º –º–∞—Ä—à—Ä—É—Ç–µ
if (!email || !password) {
  return res.status(400).json({ error: 'Email and password required' });
}

if (password.length < 8) {
  return res.status(400).json({ error: 'Password too short' });
}
```

### 2. üü° –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 2.1 –•–∞—Ä–¥–∫–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ –∫–æ–¥—É

```javascript
// –•–∞—Ä–¥–∫–æ–¥ –≤ –∫–æ–¥–µ
if (password.length < 8) { ... }
if (customCode.length < 3 || customCode.length > 50) { ... }
const maxKeys = 10;
const maxWebhooks = 5;
```

#### 2.2 –ü—Ä—è–º—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã –≤ –º–∞—Ä—à—Ä—É—Ç–∞—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –Ω–∞–¥ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

```javascript
const result = await db.query(
  'SELECT * FROM urls WHERE id = $1 AND user_id = $2',
  [id, userId]
);
```

#### 2.3 –û–±—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ

```javascript
catch (error) {
  console.error(error);
  res.status(500).json({ error: 'Internal server error' });
}
```

### 3. üü¢ –•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ (—É–∂–µ –µ—Å—Ç—å)

‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã (–∑–∞—â–∏—Ç–∞ –æ—Ç SQL injection)
‚úÖ –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π —Å bcrypt
‚úÖ JWT –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚úÖ Rate limiting
‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
‚úÖ –ò–Ω–¥–µ–∫—Å—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

---

## –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

### –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
url-shortener/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.js                    # –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.js                     # Middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ errorHandler.js             # –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ validators/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authValidator.js            # –í–∞–ª–∏–¥–∞—Ü–∏—è auth –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urlValidator.js             # –í–∞–ª–∏–¥–∞—Ü–∏—è URL –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ userRepository.js           # –†–∞–±–æ—Ç–∞ —Å users –≤ –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ urlRepository.js            # –†–∞–±–æ—Ç–∞ —Å urls –≤ –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ clickRepository.js          # –†–∞–±–æ—Ç–∞ —Å clicks –≤ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authService.js              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urlService.js               # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ URL
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authRoutes.js               # –ú–∞—Ä—à—Ä—É—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urlRoutes.js                # –ú–∞—Ä—à—Ä—É—Ç—ã URL
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îî‚îÄ‚îÄ errors.js                   # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ auth.js                             # (—Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª)
‚îú‚îÄ‚îÄ routes.js                           # (—Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª)
‚îú‚îÄ‚îÄ server.js                           # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª —Å–µ—Ä–≤–µ—Ä–∞
‚îî‚îÄ‚îÄ ...
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`src/config/index.js`)
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –í—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –£–¥–æ–±–Ω–æ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π (dev/prod)

```javascript
module.exports = {
  server: { port: 3000 },
  jwt: { secret: process.env.JWT_SECRET, expiresIn: '30d' },
  password: { minLength: 8, saltRounds: 10 },
  shortCode: { length: 6, customCodeMinLength: 3, customCodeMaxLength: 50 },
  // ...
};
```

#### 2. –ö–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫ (`src/utils/errors.js`)
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ HTTP —Å—Ç–∞—Ç—É—Å–∞
- –õ—É—á—à–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```javascript
class ValidationError extends AppError {
  constructor(message) {
    super(message, 400);
  }
}

class NotFoundError extends AppError {
  constructor(message = 'Resource not found') {
    super(message, 404);
  }
}
```

#### 3. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ production

```javascript
const errorHandler = (err, req, res, next) => {
  let statusCode = err.statusCode || 500;
  let message = err.message || 'Internal server error';

  // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
  if (statusCode === 500) {
    console.error('Error:', err);
  }

  // –°–∫—Ä—ã—Ç–∏–µ –¥–µ—Ç–∞–ª–µ–π –≤ production
  if (process.env.NODE_ENV === 'production' && statusCode === 500) {
    message = 'Internal server error';
  }

  res.status(statusCode).json({ error: message });
};
```

#### 4. –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

```javascript
const validateShortenRequest = (req, res, next) => {
  const { url, customCode, password, expiresInDays } = req.body;

  if (!url) throw new ValidationError('URL is required');
  if (!isValidUrl(url)) throw new ValidationError('Invalid URL format');

  if (customCode) {
    if (!isValidShortCode(customCode)) {
      throw new ValidationError('Invalid custom code format');
    }
  }

  next();
};
```

#### 5. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (Data Access Layer)
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –í—Å—è —Ä–∞–±–æ—Ç–∞ —Å –ë–î –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω–∏—Ç—å –ë–î
- –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –º–æ–∫–∞–º–∏

```javascript
class UrlRepository {
  async findByShortCode(shortCode) {
    const result = await db.query(
      'SELECT * FROM urls WHERE short_code = $1',
      [shortCode]
    );
    return result.rows[0] || null;
  }

  async create(urlData) {
    const { originalUrl, shortCode, userId, passwordHash, expiresAt } = urlData;
    const result = await db.query(
      'INSERT INTO urls (...) VALUES (...) RETURNING *',
      [originalUrl, shortCode, userId, passwordHash, expiresAt]
    );
    return result.rows[0];
  }
}
```

#### 6. –°–µ—Ä–≤–∏—Å—ã (Business Logic Layer)
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ—Ç–¥–µ–ª–µ–Ω–∞ –æ—Ç –º–∞—Ä—à—Ä—É—Ç–æ–≤
- –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

```javascript
class UrlService {
  async createShortUrl(urlData, userId = null) {
    const { url, customCode, password, expiresInDays } = urlData;

    // –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞
    let shortCode = customCode || generateShortCode();

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
    let exists = await urlRepository.findByShortCode(shortCode);
    while (exists) {
      shortCode = generateShortCode();
      exists = await urlRepository.findByShortCode(shortCode);
    }

    // –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è
    let passwordHash = null;
    if (password) {
      passwordHash = await bcrypt.hash(password, config.password.saltRounds);
    }

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    await urlRepository.create({
      originalUrl: url,
      shortCode,
      userId,
      passwordHash,
      expiresAt: /* ... */
    });

    return { shortUrl, qrCode, /* ... */ };
  }
}
```

#### 7. –ú–∞—Ä—à—Ä—É—Ç—ã (Controllers)
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ß–∏—Å—Ç—ã–µ –∏ –ø—Ä–æ—Å—Ç—ã–µ
- –¢–æ–ª—å–∫–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP
- –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å–µ—Ä–≤–∏—Å–∞–º

```javascript
router.post(
  '/shorten',
  validateShortenRequest,  // –í–∞–ª–∏–¥–∞—Ü–∏—è
  asyncHandler(async (req, res) => {
    const userId = req.user?.userId || null;
    const result = await urlService.createShortUrl(req.body, userId);
    res.json(result);
  })
);
```

---

## –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Å–ª–æ–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         HTTP Request/Response           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           MIDDLEWARE LAYER              ‚îÇ
‚îÇ  ‚Ä¢ Auth                                 ‚îÇ
‚îÇ  ‚Ä¢ Validation                           ‚îÇ
‚îÇ  ‚Ä¢ Error Handler                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         CONTROLLER LAYER (Routes)       ‚îÇ
‚îÇ  ‚Ä¢ authRoutes.js                        ‚îÇ
‚îÇ  ‚Ä¢ urlRoutes.js                         ‚îÇ
‚îÇ  ‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          SERVICE LAYER                  ‚îÇ
‚îÇ  ‚Ä¢ authService.js                       ‚îÇ
‚îÇ  ‚Ä¢ urlService.js                        ‚îÇ
‚îÇ  ‚Ä¢ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        REPOSITORY LAYER                 ‚îÇ
‚îÇ  ‚Ä¢ userRepository.js                    ‚îÇ
‚îÇ  ‚Ä¢ urlRepository.js                     ‚îÇ
‚îÇ  ‚Ä¢ clickRepository.js                   ‚îÇ
‚îÇ  ‚Ä¢ –†–∞–±–æ—Ç–∞ —Å –ë–î                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ            DATABASE                     ‚îÇ
‚îÇ          PostgreSQL                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã

1. **Separation of Concerns** - –∫–∞–∂–¥—ã–π —Å–ª–æ–π –∏–º–µ–µ—Ç —Å–≤–æ—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
2. **Single Responsibility** - –æ–¥–∏–Ω –∫–ª–∞—Å—Å/–º–æ–¥—É–ª—å = –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞
3. **Dependency Injection** - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∏–∑–≤–Ω–µ
4. **Error Handling** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
5. **Validation** - —Ä–∞–Ω–Ω—è—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ middleware

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —É–ª—É—á—à–µ–Ω–∏—é

### 1. üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í—ã—Å–æ–∫–∏–π

#### 1.1 –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑ —Ç–µ—Å—Ç–æ–≤ = —Ä–∏—Å–∫ –ø–æ–ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```bash
npm install --save-dev jest supertest
```

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤:**
```javascript
// tests/services/urlService.test.js
describe('UrlService', () => {
  describe('createShortUrl', () => {
    it('should create short URL with random code', async () => {
      const result = await urlService.createShortUrl({ url: 'https://example.com' });
      expect(result.shortCode).toHaveLength(6);
    });

    it('should use custom code if provided', async () => {
      const result = await urlService.createShortUrl({
        url: 'https://example.com',
        customCode: 'mycustom'
      });
      expect(result.shortCode).toBe('mycustom');
    });
  });
});
```

#### 1.2 –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Winston –∏–ª–∏ Pino

```javascript
const winston = require('winston');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
logger.info('User logged in', { userId: user.id });
logger.error('Database error', { error: err.message });
```

#### 1.3 –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
**–í–∞–∂–Ω–æ:** –°—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã `routes.js` –∏ `auth.js` –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

**–ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏:**
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
2. –û–±–Ω–æ–≤–∏—Ç—å `server.js` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Ä–æ—É—Ç–æ–≤
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
4. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã

### 2. üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°—Ä–µ–¥–Ω–∏–π

#### 2.1 –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API (Swagger)
```bash
npm install swagger-jsdoc swagger-ui-express
```

```javascript
/**
 * @swagger
 * /api/shorten:
 *   post:
 *     summary: Create short URL
 *     parameters:
 *       - in: body
 *         name: url
 *         required: true
 *         schema:
 *           type: string
 *     responses:
 *       200:
 *         description: Success
 */
```

#### 2.2 –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- Prometheus + Grafana –¥–ª—è –º–µ—Ç—Ä–∏–∫
- Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- ELK Stack –¥–ª—è –ª–æ–≥–æ–≤

#### 2.3 –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å—Å—ã–ª–æ–∫

```javascript
const redis = require('redis');
const client = redis.createClient();

// –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
const shortUrl = await cache.get(shortCode);
if (!shortUrl) {
  shortUrl = await urlRepository.findByShortCode(shortCode);
  await cache.set(shortCode, shortUrl, 'EX', 3600); // 1 —á–∞—Å
}
```

#### 2.4 –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é
**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–ø—Ä–æ—Å –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º

```javascript
router.get('/user', authenticateToken, async (req, res) => {
  const { page = 1, limit = 50 } = req.query;
  const offset = (page - 1) * limit;

  const urls = await urlRepository.findByUserId(userId, limit, offset);
  const total = await urlRepository.countByUserId(userId);

  res.json({
    data: urls,
    pagination: {
      page,
      limit,
      total,
      totalPages: Math.ceil(total / limit)
    }
  });
});
```

### 3. üü¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ù–∏–∑–∫–∏–π

#### 3.1 –î–æ–±–∞–≤–∏—Ç—å TypeScript
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –õ—É—á—à–∞—è IDE –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫

#### 3.2 –î–æ–±–∞–≤–∏—Ç—å GraphQL API
**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ REST API:**
```graphql
type Query {
  urls: [URL!]!
  url(id: ID!): URL
}

type URL {
  id: ID!
  originalUrl: String!
  shortCode: String!
  clicks: Int!
}
```

#### 3.3 –î–æ–±–∞–≤–∏—Ç—å WebSocket –¥–ª—è real-time –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
```javascript
io.on('connection', (socket) => {
  socket.on('subscribe', (urlId) => {
    socket.join(`url:${urlId}`);
  });
});

// –ü—Ä–∏ –∫–ª–∏–∫–µ
io.to(`url:${urlId}`).emit('click', clickData);
```

---

## –ú–∏–≥—Ä–∞—Ü–∏—è

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ server.js –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–ü—Ä–∏–º–µ—Ä:**
```javascript
const express = require('express');
const app = express();

// –ù–æ–≤—ã–µ –∏–º–ø–æ—Ä—Ç—ã
const urlRoutes = require('./src/routes/urlRoutes');
const authRoutes = require('./src/routes/authRoutes');
const { errorHandler } = require('./src/middleware/errorHandler');
const { asyncHandler } = require('./src/middleware/errorHandler');

// Middleware
app.use(express.json());
app.use(cors());

// –ù–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
app.use('/api/urls', urlRoutes);
app.use('/api/auth', authRoutes);
app.use('/api/user', authRoutes);

// –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–í–ê–ñ–ù–û: –í –ö–û–ù–¶–ï!)
app.use(errorHandler);
```

### Checklist –º–∏–≥—Ä–∞—Ü–∏–∏

- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –Ω–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `server.js`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å webhooks
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –∫–ª—é—á–∏
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
- [ ] –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã `routes.js` –∏ `auth.js`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

## –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏—è

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| **–†–∞–∑–º–µ—Ä –∫—Ä—É–ø–Ω–µ–π—à–µ–≥–æ —Ñ–∞–π–ª–∞** | 1448 —Å—Ç—Ä–æ–∫ | ~200 —Å—Ç—Ä–æ–∫ | üìâ 86% |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤** | 8 | 18 | üìà 125% |
| **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** | –í—ã—Å–æ–∫–æ–µ | –ù–∏–∑–∫–æ–µ | ‚úÖ |
| **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è | ‚úÖ |
| **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å** | –°–ª–æ–∂–Ω–∞—è | –ü—Ä–æ—Å—Ç–∞—è | ‚úÖ |
| **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** | –ù–µ—Ç | –ï—Å—Ç—å | ‚úÖ |

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏–ª:**
1. ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ (–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è)
2. ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞
3. ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å
4. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
5. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
6. ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
2. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Winston
3. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
4. –î–æ–±–∞–≤–∏—Ç—å Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
5. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (Redis)

---

**–ê–≤—Ç–æ—Ä:** Claude (AI Assistant)
**–î–∞—Ç–∞:** 2025-11-20
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0
